name: 🔍 Pre-Release Checks

on:
  push:
    branches:
      - develop_v1
  pull_request:
    branches:
      - develop_v1

jobs:
  validate-naming-conventions:
    name: 🔤 Validate lowercase filenames and folders.
    runs-on: ubuntu-latest

    steps:
      - name: 📥 Checkout repository
        uses: actions/checkout@v3

      - name: 🔍 Detect capitalized file or folder names
        run: |
          echo "🔍 Starting scan for files or folders with capitalized names..."
          
          # List all tracked files and detect names starting with uppercase (excluding README.md)
          capitalized_entries=$(git ls-tree -r HEAD --name-only | grep -E '^([^/]*[A-Z][^/]*)' | grep -vE '^README\.md$')

          if [ -n "$capitalized_entries" ]; then
            echo "::error::❌ Capitalized file/folder names detected:"
            echo "$capitalized_entries"
            echo ""
            echo "🚫 Please rename all files and folders to lowercase. Only 'README.md' is allowed with capital letters."
            exit 1
          else
            echo "✅ All file and folder names are lowercase. Pre-release check passed."
          fi

      - name: ✅ Success confirmation
        if: success()
        run: echo "🎉 All pre-release naming checks passed successfully!"
